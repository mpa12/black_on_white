import{T as g}from"./Toast-6f643973.js";import{_ as b,U as h,r as m,o as n,c as l,h as x,i,a as e,k as P,l as u,m as _,t as c,b as v,w as U,e as k,F as w,p as S,d as A}from"./app-f65f30b7.js";const T={name:"AdminParticipantsUpdate",components:{Toast:g},data(){return{errors:[],installedPhoto:null,name:null,role:null,photo:null,data:null,updated:!1}},mounted(){this.loadParticipant()},methods:{loadParticipant(){const t=`/api/participant/${this.$route.params.id}`,o={headers:{"Content-Type":"multipart/form-data",Authorization:h.getAuthorizationString()}};axios.get(t,o).then(a=>{this.name=a.data.data.name,this.role=a.data.data.role,this.installedPhoto=a.data.data.photo}).catch(console.error)},handlePhotoUpload(){this.photo=this.$refs.files.files[0]},getData(){let t=new FormData;t.append("name",this.name),t.append("role",this.role),t.append("photo",this.photo),this.data=t},handleResponseUpdate(t){this.errors=[],this.name=t.data.success.name,this.role=t.data.success.role,this.photo=null,this.installedPhoto=t.data.success.photo,this.updated=!0},handleErrorUpdate(t){if(t.response.status===422){this.errors=[];let o=JSON.parse(t.request.responseText).errors;for(const a in o)this.errors[a]=o[a][0]}},update(){this.getData();const t=`/api/participant/${this.$route.params.id}`,o={headers:{"Content-Type":"multipart/form-data",Authorization:h.getAuthorizationString()}};axios.post(t,this.data,o).then(this.handleResponseUpdate).catch(this.handleErrorUpdate)}}},d=t=>(S("data-v-454881aa"),t=t(),A(),t),C=d(()=>e("div",{class:"title my-3"},[e("h1",null,"Редактирование участника")],-1)),D={class:"form-wrapper"},V={class:"mb-3"},N=d(()=>e("label",{for:"name",class:"form-label"},"ФИО участника",-1)),z={key:0,class:"text-danger"},B={class:"mb-3"},I=d(()=>e("label",{for:"role",class:"form-label"},"Роль участника",-1)),O={key:0,class:"text-danger"},E={class:"mb-3"},F={key:0,class:"w-100 d-flex align-items-center justify-content-center"},M=["src"],R=d(()=>e("label",{for:"photo",class:"form-label"},"Фото участника",-1)),j={key:1,class:"text-danger"},q={class:"d-flex gap-2"},J=d(()=>e("button",{type:"submit",class:"btn btn-primary"},"Сохранить",-1));function G(t,o,a,H,s,p){const f=m("toast"),y=m("router-link");return n(),l(w,null,[s.updated?(n(),x(f,{key:0,title:"Участник успешно изменен"})):i("",!0),C,e("div",D,[e("form",{onSubmit:o[3]||(o[3]=P((...r)=>p.update&&p.update(...r),["prevent"]))},[e("div",V,[N,u(e("input",{"onUpdate:modelValue":o[0]||(o[0]=r=>s.name=r),type:"text",class:"form-control",id:"name"},null,512),[[_,s.name]]),s.errors.hasOwnProperty("name")?(n(),l("small",z,c(s.errors.name),1)):i("",!0)]),e("div",B,[I,u(e("input",{"onUpdate:modelValue":o[1]||(o[1]=r=>s.role=r),type:"text",class:"form-control",id:"role"},null,512),[[_,s.role]]),s.errors.hasOwnProperty("role")?(n(),l("small",O,c(s.errors.role),1)):i("",!0)]),e("div",E,[s.installedPhoto?(n(),l("div",F,[e("img",{src:s.installedPhoto,class:"w-50",alt:"Фото участника"},null,8,M)])):i("",!0),R,e("input",{onChange:o[2]||(o[2]=(...r)=>p.handlePhotoUpload&&p.handlePhotoUpload(...r)),ref:"files",class:"form-control",type:"file",id:"photo"},null,544),s.errors.hasOwnProperty("photo")?(n(),l("small",j,c(s.errors.photo),1)):i("",!0)]),e("div",q,[J,v(y,{class:"btn btn-secondary",to:"/admin/participants"},{default:U(()=>[k("Отмена")]),_:1})])],32)])],64)}const Q=b(T,[["render",G],["__scopeId","data-v-454881aa"]]);export{Q as default};

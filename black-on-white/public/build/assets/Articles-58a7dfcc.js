import{A as x}from"./ArticleSearch-290175f4.js";import{_ as g,V as w,r as i,o as a,c as n,a as s,t as c,b as m,L as v,f as A,F as b,g as y,h,i as k}from"./app-f65f30b7.js";import{c as F}from"./ChangeDate-db5be761.js";import"./_commonjsHelpers-87174ba5.js";const L={name:"ArticleCard",components:{VButton:w},props:["article"],methods:{changeDate:F}},B={class:"newses__card col-12 d-flex flex-column flex-lg-row"},C={class:"col-lg-6 col-12 newses__card-desc"},S={class:"newses__card-tag"},V=["src","alt"],E={class:"col-lg-6 col-12 newses__card-photo d-none d-lg-block"},D=["src","alt"];function N(t,l,e,u,o,d){const r=i("v-button");return a(),n("div",B,[s("div",C,[s("time",null,c(d.changeDate(e.article.created_at)),1),s("h1",null,c(e.article.title),1),s("span",S,c(e.article.article_type.title),1),s("img",{src:"/storage/"+e.article.photo,alt:e.article.title,class:"d-lg-none d-block"},null,8,V),s("p",null,c(e.article.description),1),m(r,{class:"mt-auto",title:"Смотреть новость",href:"/article/"+e.article.id},null,8,["href"])]),s("div",E,[s("img",{src:"/storage/"+e.article.photo,alt:e.article.title},null,8,D)])])}const P=g(L,[["render",N],["__scopeId","data-v-056e421b"]]),H={name:"Articles",components:{Loader:v,ArticleCard:P,ArticleSearch:x},data(){return{articles:[],page:1,loading:!1,totalPages:null,selectedFilters:[],text:""}},mounted(){this.loadArticles(),window.addEventListener("scroll",this.handleScroll),window.addEventListener("search",function(t){this.selectedFilters=[...t.detail.selectedFilters],this.text=t.detail.text,this.articles=[],this.page=1,this.loadArticles()}.bind(this))},destroyed(){window.removeEventListener("scroll",this.handleScroll)},methods:{loadArticles(){this.loading=!0;let t={page:this.page};this.text!==""&&(t.text=this.text),this.selectedFilters.length>0&&(t.article_type=this.selectedFilters.join(",")),A.get("/api/article",{params:t}).then(l=>{this.articles=[...this.articles,...l.data.data],this.totalPages=l.data.meta.last_page,this.loading=!1})},handleScroll(){this.loading||window.pageYOffset+window.innerHeight>=document.body.offsetHeight&&this.page<this.totalPages&&(this.page+=1,this.loadArticles())}}},j={class:"w-100 gap-3 d-flex flex-column"};function I(t,l,e,u,o,d){const r=i("article-search"),f=i("article-card"),p=i("loader");return a(),n("div",j,[m(r),(a(!0),n(b,null,y(o.articles,_=>(a(),h(f,{article:_,key:_.id},null,8,["article"]))),128)),o.loading?(a(),h(p,{key:0})):k("",!0)])}const G=g(H,[["render",I]]);export{G as default};

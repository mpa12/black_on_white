import{A as w}from"./ArticleSearch-fbca1b47.js";import{_ as f,V as x,r,o as c,c as _,a,t as o,b as u,L as v,f as b,F as y,g as H,h as m,i as L}from"./app-51fe443e.js";import{m as l}from"./moment-with-locales-723ca905.js";import"./_commonjsHelpers-87174ba5.js";const k={name:"ArticleCard",components:{VButton:x},props:["article"],data(){return{createdAt:""}},mounted(){this.changeCreatedAt(this.article.created_at)},methods:{changeCreatedAt(e){const s=new Date(e);let t=l.duration(l().diff(s));if(t.asMinutes()<60){let i=new Date().getTime()-s.getTime();i=new Date(i).getMinutes(),this.createdAt=i+" минут назад"}else t.asHours()<24?this.createdAt=l().subtract(t).format("HH часов назад"):t.asDays()<2?this.createdAt=l().subtract(t).format("Вчера в HH:mm"):(l.locale("ru"),this.createdAt=l(s).format("D MMMM в HH:mm YYYY"))}}},C={class:"newses__card col-12 d-flex flex-column flex-lg-row"},F={class:"col-lg-6 col-12 newses__card-desc"},P={class:"newses__card-tag"},V=["src","alt"],D={class:"col-lg-6 col-12 newses__card-photo d-none d-lg-block"},E=["src","alt"];function M(e,s,t,i,n,g){const d=r("v-button");return c(),_("div",C,[a("div",F,[a("time",null,o(this.createdAt),1),a("h1",null,o(t.article.title),1),a("span",P,o(t.article.article_type.title),1),a("img",{src:t.article.photo,alt:t.article.title,class:"d-lg-none d-block"},null,8,V),a("p",null,o(t.article.description),1),u(d,{class:"mt-auto",title:"Смотреть новость",href:"/article/"+t.article.id},null,8,["href"])]),a("div",D,[a("img",{src:t.article.photo,alt:t.article.title},null,8,E)])])}const B=f(k,[["render",M],["__scopeId","data-v-3f773b2e"]]),S={name:"Articles",components:{Loader:v,ArticleCard:B,ArticleSearch:w},data(){return{articles:[],page:1,loading:!1,totalPages:null,selectedFilters:[],text:""}},mounted(){this.loadArticles(),window.addEventListener("scroll",this.handleScroll),window.addEventListener("search",function(e){this.selectedFilters=[...e.detail.selectedFilters],this.text=e.detail.text,this.articles=[],this.page=1,this.loadArticles()}.bind(this))},destroyed(){window.removeEventListener("scroll",this.handleScroll)},methods:{loadArticles(){this.loading=!0;let e={page:this.page};this.text!==""&&(e.text=this.text),this.selectedFilters.length>0&&(e.article_type=this.selectedFilters.join(",")),b.get("http://localhost:8080/api/article",{params:e}).then(s=>{this.articles=[...this.articles,...s.data.data],this.totalPages=s.data.meta.last_page,this.loading=!1})},handleScroll(){this.loading||window.pageYOffset+window.innerHeight>=document.body.offsetHeight&&this.page<this.totalPages&&(this.page+=1,this.loadArticles())}}},Y={class:"w-100 gap-3 d-flex flex-column"};function U(e,s,t,i,n,g){const d=r("article-search"),p=r("article-card"),A=r("loader");return c(),_("div",Y,[u(d),(c(!0),_(y,null,H(n.articles,h=>(c(),m(p,{article:h,key:h.id},null,8,["article"]))),128)),n.loading?(c(),m(A,{key:0})):L("",!0)])}const I=f(S,[["render",U]]);export{I as default};

import{_ as f,f as h,r as M,o as i,c as r,a as e,e as g,t as n,F as u,g as v,b as k,w as x,s as _,k as p,i as y,p as V,d as I}from"./app-77659426.js";import{c as A}from"./ChangeDate-db5be761.js";import"./_commonjsHelpers-87174ba5.js";const U={name:"AdminMessages",data(){return{messages:[],currentPage:1,loading:!1,totalPages:null,deleteMessageInfo:[]}},computed:{pages(){const o=[],{currentPage:m,totalPages:P}=this;let a=Math.max(m-Math.floor(5/2),1),l=Math.min(a+5-1,P);l-a<5-1&&(a=Math.max(l-5+1,1));for(let c=a;c<=l;c++)o.push(c);return o}},mounted(){this.loadMessages()},methods:{changeDate:A,loadMessages(){this.loading=!0,h.get("/api/message?page="+this.currentPage,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(s=>{this.messages=s.data.data,this.totalPages=s.data.meta.last_page,this.loading=!1})},prevPage(){this.currentPage>1&&(this.currentPage--,this.loadMessages())},nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.loadMessages())},goToPage(s){this.currentPage!==s&&(this.currentPage=s,this.loadMessages())},loadDeleteMessage(s){h.get("/api/message/"+s,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(o=>{this.deleteMessageInfo=o.data.data})},deleteMessage(s){h.post("/api/message/"+s,{_method:"delete"},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(this.loadMessages).catch(console.error)}}},d=s=>(V("data-v-c2c51edd"),s=s(),I(),s),w={class:"modal fade",id:"deleteModal"},C={class:"modal-dialog modal-dialog-centered"},E={class:"modal-content"},L={class:"modal-header"},S={class:"modal-title fs-5"},B=d(()=>e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"},null,-1)),D={class:"modal-body"},R={class:"modal-footer justify-content-start"},N=d(()=>e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Отмена",-1)),z=d(()=>e("div",{class:"title my-3"},[e("h1",null,"Управление сообщениями")],-1)),T={class:"table-wrapper"},F={class:"table table-hover"},j=d(()=>e("thead",null,[e("tr",null,[e("th",null,"№"),e("th",null,"ID"),e("th",null,"Имя"),e("th",null,"Телефон"),e("th",null,"E-mail"),e("th",null,"Создано"),e("th",null,"Прочитано"),e("th")])],-1)),q=["title"],G=["title"],H=["title"],J={class:"dropdown"},K=d(()=>e("span",{type:"button","data-bs-toggle":"dropdown"},[e("img",{src:"/images/three-dots-vertical.svg",alt:"three-dots-vertical",type:"button","data-toggle":"dropdown"})],-1)),O={class:"dropdown-menu dropdown-menu-end"},Q=["onClick"],W={class:"pagination"},X=d(()=>e("span",{"aria-hidden":"true"},"«",-1)),Y=[X],Z=["onClick"],$=d(()=>e("span",{"aria-hidden":"true"},"»",-1)),ee=[$],te={key:0,class:"text-center"};function se(s,o,m,P,a,l){const c=M("router-link");return i(),r(u,null,[e("div",w,[e("div",C,[e("div",E,[e("div",L,[e("h1",S,[g("Удаление сообщения пользователя "),e("span",null,"«"+n(a.deleteMessageInfo.name)+"»",1)]),B]),e("div",D,[g(" Вы уверенны, что хотите удалить сообщение пользователя "),e("span",null,"«"+n(a.deleteMessageInfo.name)+"»",1),g("? ")]),e("div",R,[N,e("button",{type:"button",class:"btn btn-danger",onClick:o[0]||(o[0]=t=>l.deleteMessage(a.deleteMessageInfo.id)),"data-bs-dismiss":"modal"},"Удалить")])])])]),z,e("div",T,[e("table",F,[j,e("tbody",null,[(i(!0),r(u,null,v(a.messages,(t,b)=>(i(),r("tr",null,[e("th",null,n(b+1),1),e("td",null,n(t.id),1),e("td",{class:"text-truncate user-select-none",title:t.name},[k(c,{to:"/admin/messages/"+t.id,class:"text-decoration-none"},{default:x(()=>[g(n(t.name),1)]),_:2},1032,["to"])],8,q),e("td",{class:"text-truncate",title:t.phone},n(t.phone),9,G),e("td",{class:"text-truncate",title:t.email},n(t.email),9,H),e("td",null,n(l.changeDate(t.created_at)),1),e("td",null,[e("span",{class:_(t.is_read?"badge bg-light text-dark":"badge bg-info text-dark")},n(t.is_read?"Прочитано":"Не прочитано"),3)]),e("td",null,[e("div",J,[K,e("ul",O,[e("li",null,[e("span",{onClick:ae=>l.loadDeleteMessage(t.id),class:"dropdown-item",type:"button","data-bs-toggle":"modal","data-bs-target":"#deleteModal"}," Удалить ",8,Q)])])])])]))),256))])]),e("nav",null,[e("ul",W,[e("li",{class:_(["page-item",{disabled:a.currentPage===1}])},[e("span",{class:"page-link","aria-label":"Previous",onClick:o[1]||(o[1]=p((...t)=>l.prevPage&&l.prevPage(...t),["prevent"]))},Y)],2),(i(!0),r(u,null,v(l.pages,t=>(i(),r("li",{class:_(["page-item",{active:t===a.currentPage}]),key:t},[e("span",{class:"page-link",onClick:p(b=>l.goToPage(t),["prevent"])},n(t),9,Z)],2))),128)),e("li",{class:_(["page-item",{disabled:a.currentPage===a.totalPages}])},[e("span",{class:"page-link","aria-label":"Next",onClick:o[2]||(o[2]=p((...t)=>l.nextPage&&l.nextPage(...t),["prevent"]))},ee)],2)])])]),a.loading?(i(),r("div",te,"Loading...")):y("",!0)],64)}const de=f(U,[["render",se],["__scopeId","data-v-c2c51edd"]]);export{de as default};

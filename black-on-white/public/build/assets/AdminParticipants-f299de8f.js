import{_ as P,E as y,f as m,r as w,G as A,o as _,c as u,a as t,e as i,t as o,b as h,w as f,F as g,g as D,l as I,p as x,d as U}from"./app-38c7d57f.js";import{m as l}from"./moment-with-locales-723ca905.js";import"./_commonjsHelpers-87174ba5.js";const M={name:"AdminParticipants",directives:{tippy:y},data(){return{participants:[],deleteParticipantInfo:[]}},mounted(){this.loadParticipants()},methods:{loadParticipants(){m.get("/api/participant").then(e=>{this.participants=e.data.data})},convertDate(e){e=new Date(e);const a=l.duration(l().diff(e));if(a.asMinutes()<60){let r=new Date().getTime()-e.getTime();return r=new Date(r).getMinutes(),r+" минут назад"}else return a.asHours()<24?l().subtract(a).format("HH часов назад"):a.asDays()<2?l().subtract(a).format("Вчера в HH:mm"):(l.locale("ru"),l(e).format("D MMMM в HH:mm YYYY"))},getImgTag(e,a){return`<img width=150 style="border-radius: 10px" src="${e}" alt="${a}">`},loadDeleteParticipant(e){m.get("/api/participant/"+e).then(a=>{this.deleteParticipantInfo=a.data.data})},deleteParticipant(e){m.post("/api/participant/"+e,{_method:"delete"},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(this.loadParticipants).catch(console.error)}}},n=e=>(x("data-v-f92c50fa"),e=e(),U(),e),V={class:"modal fade",id:"deleteModal"},k={class:"modal-dialog modal-dialog-centered"},E={class:"modal-content"},L={class:"modal-header"},H={class:"modal-title fs-5"},R=n(()=>t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"},null,-1)),B={class:"modal-body"},C={class:"modal-footer justify-content-start"},S=n(()=>t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Отмена",-1)),T={class:"title my-3 d-flex align-items-center gap-3"},z=n(()=>t("h1",null,"Управление участниками театра",-1)),Y={class:"table-wrapper"},N={class:"table table-hover"},F=n(()=>t("thead",null,[t("tr",null,[t("th",null,"№"),t("th",null,"ID"),t("th",null,"ФИО"),t("th",null,"Роль"),t("th",null,"Фото"),t("th",null,"Создано"),t("th",null,"Обновлено"),t("th")])],-1)),j=["title"],G=["title"],q={width:"20",height:"20",fill:"gray",class:"bi-card-image",viewBox:"0 0 16 16"},J=n(()=>t("path",{d:"M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"},null,-1)),K=n(()=>t("path",{d:"M1.5 2A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-13zm13 1a.5.5 0 0 1 .5.5v6l-3.775-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12v.54A.505.505 0 0 1 1 12.5v-9a.5.5 0 0 1 .5-.5h13z"},null,-1)),O=[J,K],Q={class:"dropdown"},W=n(()=>t("span",{type:"button","data-bs-toggle":"dropdown"},[t("img",{src:"/images/three-dots-vertical.svg",alt:"three-dots-vertical",type:"button","data-toggle":"dropdown"})],-1)),X={class:"dropdown-menu dropdown-menu-end"},Z=["onClick"];function $(e,a,r,tt,c,d){const p=w("router-link"),v=A("tippy");return _(),u(g,null,[t("div",V,[t("div",k,[t("div",E,[t("div",L,[t("h1",H,[i("Удаление участника "),t("span",null,"«"+o(c.deleteParticipantInfo.name)+"»",1)]),R]),t("div",B,[i(" Вы уверенны, что хотите удалить участника "),t("span",null,"«"+o(c.deleteParticipantInfo.name)+"»",1),i("? ")]),t("div",C,[S,t("button",{type:"button",class:"btn btn-danger",onClick:a[0]||(a[0]=s=>d.deleteParticipant(c.deleteParticipantInfo.id)),"data-bs-dismiss":"modal"},"Удалить")])])])]),t("div",T,[z,h(p,{to:"/admin/participants/create",class:"btn btn-primary"},{default:f(()=>[i("Создать")]),_:1})]),t("div",Y,[t("table",N,[F,t("tbody",null,[(_(!0),u(g,null,D(c.participants,(s,b)=>(_(),u("tr",null,[t("th",null,o(b+1),1),t("td",null,o(s.id),1),t("td",{class:"text-truncate user-select-none",title:s.name},o(s.name),9,j),t("td",{class:"text-truncate",title:s.role},o(s.role),9,G),t("td",null,[I((_(),u("svg",q,O)),[[v,{content:d.getImgTag(s.photo,s.name)}]])]),t("td",null,o(d.convertDate(s.created_at)),1),t("td",null,o(d.convertDate(s.updated_at)),1),t("td",null,[t("div",Q,[W,t("ul",X,[t("li",null,[h(p,{class:"dropdown-item",to:"/admin/participants/update/"+s.id},{default:f(()=>[i("Редактировать")]),_:2},1032,["to"])]),t("li",null,[t("span",{onClick:et=>d.loadDeleteParticipant(s.id),class:"dropdown-item",type:"button","data-bs-toggle":"modal","data-bs-target":"#deleteModal"},"Удалить",8,Z)])])])])]))),256))])])])],64)}const nt=P(M,[["render",$],["__scopeId","data-v-f92c50fa"]]);export{nt as default};

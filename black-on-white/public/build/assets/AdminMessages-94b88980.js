import{_ as M,U as p,f as m,r as x,o as c,c as g,a as e,e as h,t as l,F as b,g as P,b as k,w as y,s as _,k as f,i as w,p as C,d as I}from"./app-f65f30b7.js";import{c as A}from"./ChangeDate-db5be761.js";import"./_commonjsHelpers-87174ba5.js";const V={name:"AdminMessages",data(){return{messages:[],currentPage:1,loading:!1,totalPages:null,deleteMessageInfo:[]}},computed:{pages(){const s=[],{currentPage:i,totalPages:r}=this;let o=Math.max(i-Math.floor(5/2),1),n=Math.min(o+5-1,r);n-o<5-1&&(o=Math.max(n-5+1,1));for(let u=o;u<=n;u++)s.push(u);return s}},mounted(){this.loadMessages()},methods:{changeDate:A,loadMessages(){this.loading=!0;const a="/api/message?page="+this.currentPage,s={headers:{Authorization:p.getAuthorizationString()}};m.get(a,s).then(i=>{this.messages=i.data.data,this.totalPages=i.data.meta.last_page,this.loading=!1})},prevPage(){this.currentPage>1&&(this.currentPage--,this.loadMessages())},nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.loadMessages())},goToPage(a){this.currentPage!==a&&(this.currentPage=a,this.loadMessages())},loadDeleteMessage(a){const s="/api/message/"+a,i={headers:{Authorization:p.getAuthorizationString()}};m.get(s,i).then(r=>{this.deleteMessageInfo=r.data.data})},deleteMessage(a){const s="/api/message/"+a,i={_method:"delete"},r={headers:{Authorization:p.getAuthorizationString()}};m.post(s,i,r).then(this.loadMessages).catch(console.error)}}},d=a=>(C("data-v-2f793010"),a=a(),I(),a),z={class:"modal fade",id:"deleteModal"},S={class:"modal-dialog modal-dialog-centered"},D={class:"modal-content"},N={class:"modal-header"},B={class:"modal-title fs-5"},T=d(()=>e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"},null,-1)),E={class:"modal-body"},F={class:"modal-footer justify-content-start"},L=d(()=>e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Отмена",-1)),U=d(()=>e("div",{class:"title my-3"},[e("h1",null,"Управление сообщениями")],-1)),j={class:"table-wrapper"},q={class:"table table-hover"},G=d(()=>e("thead",null,[e("tr",null,[e("th",null,"№"),e("th",null,"ID"),e("th",null,"Имя"),e("th",null,"Телефон"),e("th",null,"E-mail"),e("th",null,"Создано"),e("th",null,"Прочитано"),e("th")])],-1)),H=["title"],J=["title"],K=["title"],O={class:"dropdown"},Q=d(()=>e("span",{type:"button","data-bs-toggle":"dropdown"},[e("img",{src:"/images/three-dots-vertical.svg",alt:"three-dots-vertical",type:"button","data-toggle":"dropdown"})],-1)),R={class:"dropdown-menu dropdown-menu-end"},W=["onClick"],X={class:"pagination"},Y=d(()=>e("span",{"aria-hidden":"true"},"«",-1)),Z=[Y],$=["onClick"],ee=d(()=>e("span",{"aria-hidden":"true"},"»",-1)),te=[ee],se={key:0,class:"text-center"};function ae(a,s,i,r,o,n){const u=x("router-link");return c(),g(b,null,[e("div",z,[e("div",S,[e("div",D,[e("div",N,[e("h1",B,[h("Удаление сообщения пользователя "),e("span",null,"«"+l(o.deleteMessageInfo.name)+"»",1)]),T]),e("div",E,[h(" Вы уверенны, что хотите удалить сообщение пользователя "),e("span",null,"«"+l(o.deleteMessageInfo.name)+"»",1),h("? ")]),e("div",F,[L,e("button",{type:"button",class:"btn btn-danger",onClick:s[0]||(s[0]=t=>n.deleteMessage(o.deleteMessageInfo.id)),"data-bs-dismiss":"modal"},"Удалить")])])])]),U,e("div",j,[e("table",q,[G,e("tbody",null,[(c(!0),g(b,null,P(o.messages,(t,v)=>(c(),g("tr",null,[e("th",null,l(v+1),1),e("td",null,l(t.id),1),e("td",{class:"text-truncate user-select-none",title:t.name},[k(u,{to:"/admin/messages/"+t.id,class:"text-decoration-none"},{default:y(()=>[h(l(t.name),1)]),_:2},1032,["to"])],8,H),e("td",{class:"text-truncate",title:t.phone},l(t.phone),9,J),e("td",{class:"text-truncate",title:t.email},l(t.email),9,K),e("td",null,l(n.changeDate(t.created_at)),1),e("td",null,[e("span",{class:_(t.is_read?"badge bg-light text-dark":"badge bg-info text-dark")},l(t.is_read?"Прочитано":"Не прочитано"),3)]),e("td",null,[e("div",O,[Q,e("ul",R,[e("li",null,[e("span",{onClick:oe=>n.loadDeleteMessage(t.id),class:"dropdown-item",type:"button","data-bs-toggle":"modal","data-bs-target":"#deleteModal"}," Удалить ",8,W)])])])])]))),256))])]),e("nav",null,[e("ul",X,[e("li",{class:_(["page-item",{disabled:o.currentPage===1}])},[e("span",{class:"page-link","aria-label":"Previous",onClick:s[1]||(s[1]=f((...t)=>n.prevPage&&n.prevPage(...t),["prevent"]))},Z)],2),(c(!0),g(b,null,P(n.pages,t=>(c(),g("li",{class:_(["page-item",{active:t===o.currentPage}]),key:t},[e("span",{class:"page-link",onClick:f(v=>n.goToPage(t),["prevent"])},l(t),9,$)],2))),128)),e("li",{class:_(["page-item",{disabled:o.currentPage===o.totalPages}])},[e("span",{class:"page-link","aria-label":"Next",onClick:s[2]||(s[2]=f((...t)=>n.nextPage&&n.nextPage(...t),["prevent"]))},te)],2)])])]),o.loading?(c(),g("div",se,"Loading...")):w("",!0)],64)}const de=M(V,[["render",ae],["__scopeId","data-v-2f793010"]]);export{de as default};
